<!doctype html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <title>Human or AI - Makale Özeti Tahmini</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    /* Arka plan (tek tema) */
    body {
      background: radial-gradient(circle at top, #1e293b, #020617 40%, #020617);
      background-size: 200% 200%;
      animation: gradientMove 18s ease-in-out infinite;
      color: #e5e7eb;
    }

    @keyframes gradientMove {
      0%   { background-position: 0% 0%; }
      50%  { background-position: 100% 100%; }
      100% { background-position: 0% 0%; }
    }

    /* Kart */
    .glass-card {
      backdrop-filter: blur(18px);
      background: rgba(15, 23, 42, 0.82);
      box-shadow:
        0 0 0 1px rgba(148, 163, 184, 0.25),
        0 22px 45px rgba(15, 23, 42, 0.85),
        0 0 60px rgba(56, 189, 248, 0.15);
    }

    /* Sonuç giriş animasyonu */
    .fade-in-up {
      animation: fadeInUp 0.55s ease-out forwards;
    }

    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(18px); }
      to   { opacity: 1; transform: translateY(0); }
    }

    /* Buton pulse */
    .btn-pulse { animation: btnPulse 0.25s ease-out; }
    @keyframes btnPulse {
      0% { transform: scale(1); }
      40% { transform: scale(0.95); }
      100% { transform: scale(1); }
    }

    /* Donut animasyonu */
    #donutCircle {
      transition: stroke-dashoffset 0.7s ease-out;
      transform: rotate(-90deg);
      transform-origin: 50% 50%;
    }
  </style>
</head>

<body class="min-h-screen flex items-center justify-center p-4">
  <div class="w-full max-w-4xl glass-card rounded-3xl p-6 md:p-8 space-y-6">

    <!-- Başlık -->
    <header class="space-y-2">
      <p class="text-xs md:text-sm uppercase tracking-[0.3em] text-sky-300/70">
        • Human or AI
      </p>
      <h1 class="text-3xl md:text-4xl font-bold tracking-tight">
        <span class="bg-clip-text text-transparent bg-gradient-to-r from-sky-400 via-cyan-300 to-emerald-300">
          Human or AI Classifier
        </span>
      </h1>
      <p class="text-sm md:text-base text-slate-300/90">
        Makale özetinizi yazın,
        <span class="font-semibold text-emerald-300">Human</span> /
        <span class="font-semibold text-sky-300">AI</span> olasılıklarını analiz edin.
      </p>
    </header>

    <!-- Özet Giriş -->
    <section class="space-y-3">
      <label for="summary" class="block text-sm font-medium text-slate-100">
        Makale Özeti
      </label>

      <textarea id="summary" rows="7"
        class="w-full rounded-2xl bg-slate-950/75 border border-slate-700/80
               focus:border-sky-400 focus:ring-2 focus:ring-sky-500/40
               outline-none text-sm md:text-base p-3 md:p-4 resize-y
               shadow-inner shadow-slate-950"
        placeholder="Özeti yazın"></textarea>

      <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-3">
        <p id="errorMsg" class="text-sm text-rose-400 hidden">
          Özet girin.
        </p>

        <button id="analyzeBtn"
          class="inline-flex items-center justify-center gap-2 px-5 py-2.5 rounded-2xl
                 bg-gradient-to-r from-sky-500 via-cyan-400 to-emerald-400
                 hover:from-sky-400 hover:via-cyan-300 hover:to-emerald-300
                 text-sm md:text-base font-semibold text-slate-950
                 shadow-lg shadow-sky-500/40
                 transition-transform transition-shadow
                 hover:shadow-cyan-400/60 hover:-translate-y-[1px]">
          <span>Özeti Analiz Et</span>
          <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none"
               viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.6"
                  d="M14.5 4.5L21 11m0 0-6.5 6.5M21 11H3" />
          </svg>
        </button>
      </div>
    </section>

    <!-- Sonuç -->
    <section id="resultSection" class="space-y-5 opacity-0 hidden">
      <div class="rounded-2xl border border-slate-700/80 bg-slate-950/70 p-4 md:p-5 space-y-4 shadow-xl shadow-sky-900/50">
        <div class="flex items-center justify-between gap-2">
          <h2 class="text-lg md:text-xl font-semibold flex items-center gap-2 text-slate-100">
            Genel Tahmin
            <span class="inline-flex h-2 w-2 rounded-full bg-emerald-400 animate-pulse"></span>
          </h2>
          <span id="overallLabel"
            class="text-xs md:text-sm px-3 py-1 rounded-full bg-sky-500/10 text-sky-300 border border-sky-500/40">
            Örnek Tahmin
          </span>
        </div>

        <div class="flex flex-col md:flex-row md:items-center gap-5 md:gap-7">
          <!-- Donut -->
          <div class="flex items-center justify-center">
            <div class="relative h-28 w-28">
              <svg viewBox="0 0 100 100" class="h-full w-full">
                <circle cx="50" cy="50" r="36"
                  stroke="#1f2937" stroke-width="10" fill="none" stroke-linecap="round" />
                <circle id="donutCircle" cx="50" cy="50" r="36"
                  stroke="url(#aiGradient)" stroke-width="10" fill="none" stroke-linecap="round"
                  stroke-dasharray="226" stroke-dashoffset="226" />
                <defs>
                  <linearGradient id="aiGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                    <stop offset="0%" stop-color="#38bdf8" />
                    <stop offset="50%" stop-color="#22d3ee" />
                    <stop offset="100%" stop-color="#22c55e" />
                  </linearGradient>
                </defs>
              </svg>
              <div class="absolute inset-0 flex flex-col items-center justify-center">
                <span class="text-[11px] uppercase tracking-wide text-slate-400">AI</span>
                <span id="donutLabel" class="text-lg font-semibold text-sky-200">%0</span>
              </div>
            </div>
          </div>

          <!-- Bar -->
          <div class="flex-1 space-y-3">
            <div class="flex justify-between text-xs md:text-sm text-slate-400">
              <span>Human</span>
              <span>AI</span>
            </div>
            <div class="w-full h-4 rounded-full bg-slate-800/80 overflow-hidden flex">
            <div
              id="humanBar"
            class="h-full bg-gradient-to-r from-emerald-400 to-emerald-300 transition-all duration-700">
            </div>
            <div
            id="aiBar"
           class="h-full bg-gradient-to-r from-sky-400 to-cyan-300 transition-all duration-700">
            </div>
            </div>

            <div class="flex justify-between text-xs md:text-sm font-medium">
               <span id="humanPercent" class="text-emerald-300">Human %0</span>
              <span id="aiPercent" class="text-sky-300">AI %0</span>
            </div>

          </div>
        </div>
      </div>

      <!-- 3 Model -->
      <div class="grid gap-4 md:grid-cols-3">
        <div class="rounded-2xl border border-slate-700/70 bg-slate-950/60 p-3 space-y-1">
          <h3 class="text-sm font-semibold text-slate-100 flex items-center gap-1.5">
            <span class="w-1.5 h-1.5 rounded-full bg-sky-400"></span>
            Logistic Regression
          </h3>
          <p id="model1Text" class="text-xs text-slate-400">Human %0 – AI %0</p>
        </div>
        <div class="rounded-2xl border border-slate-700/70 bg-slate-950/60 p-3 space-y-1">
          <h3 class="text-sm font-semibold text-slate-100 flex items-center gap-1.5">
            <span class="w-1.5 h-1.5 rounded-full bg-cyan-400"></span>
            SVM
          </h3>
          <p id="model2Text" class="text-xs text-slate-400">Human %0 – AI %0</p>
        </div>
        <div class="rounded-2xl border border-slate-700/70 bg-slate-950/60 p-3 space-y-1">
          <h3 class="text-sm font-semibold text-slate-100 flex items-center gap-1.5">
            <span class="w-1.5 h-1.5 rounded-full bg-emerald-400"></span>
            Random Forest
          </h3>
          <p id="model3Text" class="text-xs text-slate-400">Human %0 – AI %0</p>
        </div>
      </div>
    </section>

    <footer class="pt-2 border-t border-slate-800/70 text-[11px] md:text-xs text-slate-500">
      Human or AI 
    </footer>
  </div>

  <script>
    const summaryEl       = document.getElementById("summary");
    const errorMsg        = document.getElementById("errorMsg");
    const analyzeBtn      = document.getElementById("analyzeBtn");
    const resultSection   = document.getElementById("resultSection");

    const humanBar        = document.getElementById("humanBar");
    const aiBar           = document.getElementById("aiBar");
    const humanPercentTxt = document.getElementById("humanPercent");
    const aiPercentTxt    = document.getElementById("aiPercent");
    const overallLabel    = document.getElementById("overallLabel");

    const model1Text      = document.getElementById("model1Text");
    const model2Text      = document.getElementById("model2Text");
    const model3Text      = document.getElementById("model3Text");

    const donutCircle     = document.getElementById("donutCircle");
    const donutLabel      = document.getElementById("donutLabel");

    const DONUT_CIRCUMFERENCE = 2 * Math.PI * 36;
    donutCircle.style.strokeDasharray = DONUT_CIRCUMFERENCE;
    donutCircle.style.strokeDashoffset = DONUT_CIRCUMFERENCE;

    function playResultAnimation() {
      resultSection.classList.remove("hidden");
      resultSection.classList.remove("fade-in-up");
      void resultSection.offsetWidth;
      resultSection.classList.add("fade-in-up");
      resultSection.style.opacity = "1";
    }

    function updateDonut(aiPercent) {
      const offset = DONUT_CIRCUMFERENCE * (1 - aiPercent / 100);
      donutCircle.style.strokeDashoffset = offset;
      donutLabel.textContent = "%" + aiPercent.toFixed(0);
    }

    async function fetchPredictions(text) {
      const res = await fetch("/predict", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ text })
      });

      const data = await res.json();
      if (!res.ok) throw new Error(data.error || "Prediction failed");
      return data;
    }

    function setOverallFrom(ai, human) {
      if (ai > human) {
        overallLabel.textContent = "Genel Tahmin: AI Üretimi Benzeri";
        overallLabel.className =
          "text-xs md:text-sm px-3 py-1 rounded-full bg-sky-500/10 text-sky-300 border border-sky-500/40";
      } else {
        overallLabel.textContent = "Genel Tahmin: Human Yazımı Benzeri";
        overallLabel.className =
          "text-xs md:text-sm px-3 py-1 rounded-full bg-emerald-500/10 text-emerald-300 border border-emerald-500/40";
      }
    }

    async function analyzeText() {
      const text = summaryEl.value.trim();

      analyzeBtn.classList.remove("btn-pulse");
      void analyzeBtn.offsetWidth;
      analyzeBtn.classList.add("btn-pulse");

      analyzeBtn.disabled = true;
      const oldBtn = analyzeBtn.innerHTML;
      analyzeBtn.innerHTML = `<span>Analiz ediliyor...</span>`;

      try {
        if (!text) {
          errorMsg.textContent = "Lütfen özet girin.";
          errorMsg.classList.remove("hidden");
          resultSection.classList.add("hidden");
          return;
        }
        if (text.length < 30) {
          errorMsg.textContent = "Özet en az 30 karakter olmalı.";
          errorMsg.classList.remove("hidden");
          resultSection.classList.add("hidden");
          return;
        }
        errorMsg.classList.add("hidden");

        const data = await fetchPredictions(text);

        const lr  = data["Logistic Regression"];
        const svm = data["SVM"];
        const rf  = data["Random Forest"];

        const ai =
         (Number(lr["AI %"]) +
          Number(svm["AI %"]) +
          Number(rf["AI %"])) / 3;

        const human = 100 - ai;


        humanBar.style.width = human + "%";
        aiBar.style.width = ai + "%";
        humanPercentTxt.textContent = `Human %${human.toFixed(2)}`;
        aiPercentTxt.textContent = `AI %${ai.toFixed(2)}`;

        updateDonut(ai);
        setOverallFrom(ai, human);

        model1Text.textContent = `Human %${lr["Human %"].toFixed(2)} – AI %${lr["AI %"].toFixed(2)}`;
        model2Text.textContent = `Human %${svm["Human %"].toFixed(2)} – AI %${svm["AI %"].toFixed(2)}`;
        model3Text.textContent = `Human %${rf["Human %"].toFixed(2)} – AI %${rf["AI %"].toFixed(2)}`;

        playResultAnimation();
      } catch (err) {
        errorMsg.textContent = err.message || "Bir hata oluştu.";
        errorMsg.classList.remove("hidden");
        resultSection.classList.add("hidden");
      } finally {
        analyzeBtn.disabled = false;
        analyzeBtn.innerHTML = oldBtn;
      }
    }

    analyzeBtn.addEventListener("click", analyzeText);
  </script>
</body>
</html>
